"use strict";(self.webpackChunkambari_website=self.webpackChunkambari_website||[]).push([[2694],{28453:(n,e,a)=>{a.d(e,{R:()=>r,x:()=>t});var s=a(96540);const i={},c=s.createContext(i);function r(n){const e=s.useContext(c);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),s.createElement(c.Provider,{value:e},n.children)}},88378:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"ambari-design/stack-and-services/management-packs","title":"Management Packs","description":"Background","source":"@site/docs/ambari-design/stack-and-services/management-packs.md","sourceDirName":"ambari-design/stack-and-services","slug":"/ambari-design/stack-and-services/management-packs","permalink":"/docs/next/ambari-design/stack-and-services/management-packs","draft":false,"unlisted":false,"editUrl":"https://github.com/vivostar/vivostar.github.io/tree/master/docs/ambari-design/stack-and-services/management-packs.md","tags":[],"version":"current","frontMatter":{},"sidebar":"ambariSidebar","previous":{"title":"How-To Define Stacks and Services","permalink":"/docs/next/ambari-design/stack-and-services/how-to-define-stacks-and-services"},"next":{"title":"Stack Inheritance","permalink":"/docs/next/ambari-design/stack-and-services/stack-inheritance"}}');var i=a(74848),c=a(28453);const r={},t="Management Packs",d={},l=[{value:"<strong>Background</strong>",id:"background",level:2},{value:"<strong>Apache JIRA</strong>",id:"apache-jira",level:2},{value:"<strong>Release Timelines</strong>",id:"release-timelines",level:2},{value:"<strong>Management Pack Metadata (Mpack.json)</strong>",id:"management-pack-metadata-mpackjson",level:2},{value:"<strong>Management Pack Structure</strong>",id:"management-pack-structure",level:2},{value:"StackXYZ Management Pack Structure",id:"stackxyz-management-pack-structure",level:3},{value:"StackXYZ Management Pack Mpack.json",id:"stackxyz-management-pack-mpackjson",level:3},{value:"Add\xad-On Service Management Pack Structure",id:"add-on-service-management-pack-structure",level:3},{value:"Add\xad-On Service Management Pack Mpack.json",id:"add-on-service-management-pack-mpackjson",level:3},{value:"<strong>Installing Management Pack</strong>",id:"installing-management-pack",level:2},{value:"<strong>Upgrading Management Pack</strong>",id:"upgrading-management-pack",level:2}];function o(n){const e={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"management-packs",children:"Management Packs"})}),"\n",(0,i.jsx)(e.h2,{id:"background",children:(0,i.jsx)(e.strong,{children:"Background"})}),"\n",(0,i.jsx)(e.p,{children:'At present, stack definitions are bundled with Ambari core and are part of Apache Ambari releases. This enforces having to do an Ambari release with updated stack definitions whenever a new version of a stack is released. Also to add an "add-on" service (custom service) to the stack definition, one has to manually add the add-on service to the stack definition on an Ambari Server. There is no release vehicle that can be used to ship add-on services.'}),"\n",(0,i.jsx)(e.p,{children:"Apache Ambari Management Packs addresses this issue by decoupling Ambari's core functionality (cluster management and monitoring) from stack management and definition. An Apache Ambari Management Pack (Mpack) can bundle multiple service definitions, stack definitions, stack add-on service definitions, view definitions services so that releasing these artifacts don't enforce an Apache Ambari release. Apache Ambari Management Packs will be released as separate release artifacts and will follow its own release cadence instead of being tightly coupled with Apache Ambari releases."}),"\n",(0,i.jsx)(e.p,{children:"Management packs are released as tarballs, however they contain a metadata file (mpack.json) that specify the contents of the management pack and actions to perform when installing the management pack."}),"\n",(0,i.jsx)(e.h2,{id:"apache-jira",children:(0,i.jsx)(e.strong,{children:"Apache JIRA"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.a,{href:"https://issues.apache.org/jira/browse/AMBARI-14854",children:"AMBARI-14854"})}),"\n",(0,i.jsx)(e.h2,{id:"release-timelines",children:(0,i.jsx)(e.strong,{children:"Release Timelines"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Short Term Goals (Apache Ambari 2.4.0.0 release)"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Provide a release vehicle for stack definitions (example",":HDP"," management pack, IOP management pack)."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Provide a release vehicle for add-on/custom services (example: Microsoft-R management pack)"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Retrofit in existing stack processing infrastructure"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Command line to update stack definitions and service definitions"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Long Term Goals (Ambari 2.4+)"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Release HDP stacks as mpacks"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Build management pack processing infrastructure that will replace the stack processing infrastructure."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Dynamic creation of stack definitions by processing management packs"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Provide a REST API adding/removing /upgrading managment packs."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"management-pack-metadata-mpackjson",children:(0,i.jsx)(e.strong,{children:"Management Pack Metadata (Mpack.json)"})}),"\n",(0,i.jsx)(e.p,{children:"Management pack should contain following metadata information in mpack.json."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Name"}),": Unique management pack name"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Version"}),": Management pack version"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Description"}),": Friendly description of the management pack"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Prerequisites"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Minimum Ambari Version on which the management pack is installable."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Example"}),": To install stackXYZ-\xadambari-\xadmpack\xad1.0.0.0 management pack, Ambari should be atleast on Apache Ambari 2.4.0.0 version."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Minimum management pack version that should be installed before upgrading to this management pack."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Example"}),": To upgrade to stackXYZ-\xadambari\xad-mpack\xad-2.0.0.0 management pack, stackXYZ-\xadambari-\xadmpack-\xad1.8.0.0 management pack or higher should be installed."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Minimum stack version that should already be present in the stack definitions for this management pack to be applicable."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Example"}),": To add a add-on service management pack myservice-\xadambari\xad-mpack\xad-1.0.0.0 management pack stackXYZ-\xad2.1 stack definition should be present."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Artifacts"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"List of release artifacts (service definitions, stack definitions, stack-addon-service-definitions, view-definitions) bundled in the management pack."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Metadata for each artifact like source directory, additional applicability for that artifact etc."}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Supported Artifact Types"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"service\xad-definitions"}),": Contains service definitions similar to common-services/serviceA/1.0.0"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"stack-\xaddefinitions"}),": Contains stack definitions similar to stacks/stackXYZ/1.0"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"extension-definitions"}),": Contains dynamic stack extensions (Refer:",(0,i.jsx)(e.a,{href:"/docs/next/ambari-design/stack-and-services/extensions",children:"Extensions"}),")"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"stack\xad-addon-service-\xaddefinitions"}),": Defines add-on service applicability for stacks and how to merge the add-on service into the stack definition."]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"view\xad-definitions"})," (Not supported in Apache Ambari 2.4.0.0)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"A management pack can have more than one release artifacts."}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Example"}),": It should be possible to create a management pack that bundles together","\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"stack-definitions"}),": stackXYZ\xad-1.0, stackXYZ-1.1, stackXYZ-2.0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"service-definitions"}),": HAWQ, HDFS, ZOOKEEPER"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"stack-addon-service-definitions"}),": HAWQ/2.0.0 is applicable to stackXYZ-2.0, stackABC-1.0"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"view-definitions"}),": Hive, Jobs, Slider (Apache Ambari 2.4.0.0)"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"management-pack-structure",children:(0,i.jsx)(e.strong,{children:"Management Pack Structure"})}),"\n",(0,i.jsx)(e.h3,{id:"stackxyz-management-pack-structure",children:"StackXYZ Management Pack Structure"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"stackXYZ\xad-ambari\xad-mpack-\xad1.0.0.0"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u251c\u2500\u2500 mpack.json\n\n\u251c\u2500\u2500 common-\xadservices\n\n\u2502     \u2514\u2500\u2500 HDFS\n\n\u2502         \u2514\u2500\u2500 2.1.0.2.0\n\n\u2502            \u2514\u2500\u2500 configuration\n\n\u2514\u2500\u2500 stacks\n\n    \u2514\u2500\u2500 stackXYZ\n\n       \u2514\u2500\u2500 1.0\n\n           \u251c\u2500\u2500 metainfo.xml\n\n           \u251c\u2500\u2500 repos\n\n           \u2502     \u2514\u2500\u2500 repoinfo.xml\n\n           \u251c\u2500\u2500 role_command_order.json\n\n           \u2514\u2500\u2500 services\n\n           \u251c\u2500\u2500 HDFS\n\n           \u2502      \u251c\u2500\u2500 configuration\n\n           \u2502      \u2502     \u2514\u2500\u2500 hdfs-\xadsite.xml\n\n           \u2502     \u2514\u2500\u2500 metainfo.xml\n\n           \u251c\u2500\u2500 stack_advisor.py\n\n           \u2514\u2500\u2500 ZOOKEEPER\n\n                   \u2514\u2500\u2500 metainfo.xml\n"})}),"\n",(0,i.jsx)(e.h3,{id:"stackxyz-management-pack-mpackjson",children:"StackXYZ Management Pack Mpack.json"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"stackXYZ-\xadambari-\xadmpack\xad1.0.0.0/mpack.json"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\n\n    "type" : "full\xad-release",\n\n    "name" : "stackXYZ-\xadambari\xad-mpack",\n\n    "version": "1.0.0.0",\n\n    "description" : "StackXYZ Management Pack",\n\n    "prerequisites": {\n\n        "min_ambari_version" : "2.4.0.0"\n\n    },\n\n    "artifacts": [\n\n        {\n\n            "name" : "stackXYZ-service-definitions",\n\n            "type" : "service-\xaddefinitions",\n\n            "source_dir": "common-\xadservices"\n\n        },\n\n       {\n\n           "name" : "stackXYZ-\xadstack-\xaddefinitions",\n\n           "type" : "stack\xad-definitions",\n\n           "source_dir": "stacks"\n\n        }\n\n    ]\n\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"add-on-service-management-pack-structure",children:"Add\xad-On Service Management Pack Structure"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"myservice-\xadambari\xad-mpack\xad-1.0.0.0"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u251c\u2500\u2500 common\xad-services\n\n\u2502     \u2514\u2500\u2500 MYSERVICE\n\n\u2502         \u2514\u2500\u2500 1.0.0\n\n\u2502         \u251c\u2500\u2500 configuration\n\n\u2502         \u2502     \u2514\u2500\u2500 myservice\xadconfig.xml\n\n\u2502         \u251c\u2500\u2500 metainfo.xml\n\n\u2502         \u251c\u2500\u2500 package\n\n\u2502         \u2502     \u2514\u2500\u2500 scripts\n\n\u2502         \u2502         \u251c\u2500\u2500 client.py\n\n\u2502         \u2502         \u251c\u2500\u2500 master.py\n\n\u2502         \u2502         \u2514\u2500\u2500 slave.py\n\n\u2502         \u2514\u2500\u2500 role_command_order.json\n\n\u251c\u2500\u2500 custom\xad-services\n\n\u2502     \u2514\u2500\u2500 MYSERVICE\n\n\u2502     \u251c\u2500\u2500 1.0.0\n\n\u2502     \u2502    \u2514\u2500\u2500 metainfo.xml\n\n\u2502     \u2514\u2500\u2500 2.0.0\n\n\u2502         \u2514\u2500\u2500 metainfo.xml\n\n\u2514\u2500\u2500 mpack.json\n"})}),"\n",(0,i.jsx)(e.h3,{id:"add-on-service-management-pack-mpackjson",children:"Add\xad-On Service Management Pack Mpack.json"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.em,{children:"myservice-\xadambari-\xadmpack\xad-1.0.0.0/mpack.json"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'{\n\n    "type" : "full\xad-release",\n\n    "name" : "myservice-\xadambari\xad-mpack",\n\n    "version": "1.0.0.0",\n\n    "description" : "MyService Management Pack",\n\n    "prerequisites": {\n\n        "min-\xadambari-\xadversion" : "2.4.0.0",\n\n        "min\xad-stack\xad-versions" : [\n\n            {\n\n                "stack_name" : "stackXYZ",\n\n                "stack_version" : "2.2"\n\n           }\n\n        ]\n\n    },\n\n    "artifacts": [\n\n        {\n\n            "name" : "MYSERVICE\xad-service-definition",\n\n            "type" : "service\xad-definition",\n\n           "source_dir" : "common\xad-services/MYSERVICE/1.0.0",\n\n           "service_name" : "MYSERVICE",\n\n           "service_version" : "1.0.0"\n\n        },\n\n       {  \n\n           "name" : "MYSERVICE\xad-1.0.0",\n\n           "type" : "stack\xad-addon-service-\xaddefinition",\n\n           "source_dir": "addon-services/MYSERVICE/1.0.0",\n\n           "service_name" : "MYSERVICE",\n\n           "service_version" : "1.0.0",\n\n           "applicable_stacks" : [\n\n               {\n\n                   "stack_name" : "stackXYZ", "stack_version" : "2.2"\n\n               }\n\n            ]\n\n        },\n\n       {\n\n           "name" : "MYSERVICE\xad-2.0.0",\n\n           "type" : "stack-addon-service-definition",\n\n           "source_dir": "custom\xad-services/MYSERVICE/2.0.0",\n\n           "service_name" : "MYSERVICE",\n\n           "service_version" : "2.0.0",\n\n           "applicable_stacks" : [\n\n               {\n\n                   "stack_name" : "stackXYZ",\n\n                   "stack_version" : "2.4"\n\n                }\n\n            ]\n\n        }\n\n    ]\n\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"installing-management-pack",children:(0,i.jsx)(e.strong,{children:"Installing Management Pack"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ambari-\xadserver install-\xadmpack \xad\xad--mpack=/path/to/mpack.tar.gz --\xad\xadpurge --verbose\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Note"}),': Do not pass the "--purge" command line parameter when installing an add-on service management pack. The "--purge" flag is used to purge any existing stack definition (HDP is included in Ambari release) and should be included only when installing a Stack Management Pack.']}),"\n",(0,i.jsx)(e.h2,{id:"upgrading-management-pack",children:(0,i.jsx)(e.strong,{children:"Upgrading Management Pack"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ambari-server upgrade-mpack --mpack=/path/to/mpack.tar.gz --verbose\n"})})]})}function m(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(o,{...n})}):o(n)}}}]);