"use strict";(self.webpackChunkambari_website=self.webpackChunkambari_website||[]).push([[6890],{3905:(e,t,r)=>{r.d(t,{Zo:()=>b,kt:()=>u});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),d=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},b=function(e){var t=d(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,b=s(e,["components","mdxType","originalType","parentName"]),c=d(r),u=a,m=c["".concat(l,".").concat(u)]||c[u]||p[u]||i;return r?n.createElement(m,o(o({ref:t},b),{},{components:r})):n.createElement(m,o({ref:t},b))}));function u(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var d=2;d<i;d++)o[d]=r[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},5075:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var n=r(7462),a=(r(7294),r(3905));const i={slug:"/kerberos"},o="Ambari Kerberos Automation",s={unversionedId:"ambari-design/kerberos/index",id:"version-2.7.6/ambari-design/kerberos/index",title:"Ambari Kerberos Automation",description:"\x3c!---",source:"@site/versioned_docs/version-2.7.6/ambari-design/kerberos/index.md",sourceDirName:"ambari-design/kerberos",slug:"/kerberos",permalink:"/docs/kerberos",draft:!1,editUrl:"https://github.com/vivostar/vivostar.github.io/tree/master/versioned_docs/version-2.7.6/ambari-design/kerberos/index.md",tags:[],version:"2.7.6",frontMatter:{slug:"/kerberos"},sidebar:"ambariSidebar",previous:{title:"Alerts",permalink:"/docs/ambari-design/alerts"},next:{title:"The Kerberos Descriptor",permalink:"/docs/ambari-design/kerberos/kerberos_descriptor"}},l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"How it works",id:"how-it-works",level:3},{value:"Enabling Kerberos",id:"enabling-kerberos",level:3},{value:"Adding Components",id:"adding-components",level:3},{value:"Adding Hosts",id:"adding-hosts",level:3},{value:"Regenerating Keytabs",id:"regenerating-keytabs",level:3},{value:"Disabling Kerberos",id:"disabling-kerberos",level:3}],b={toc:d};function p(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},b,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"ambari-kerberos-automation"},"Ambari Kerberos Automation"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#introduction"},"Introduction"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#how-it-works"},"How it Works")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#enabling-kerberos"},"Enabling Kerberos")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#adding-components"},"Adding Components")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#adding-hosts"},"Adding Hosts")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#regenerating-keytabs"},"Regenerating Keytabs")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#disabling-kerberos"},"Disabling Kerberos")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/ambari-design/kerberos/kerberos_descriptor"},"The Kerberos Descriptor")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/ambari-design/kerberos/kerberos_service"},"The Kerberos Service")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/ambari-design/kerberos/enabling_kerberos"},"Enabling Kerberos"))),(0,a.kt)("a",{name:"introduction"}),(0,a.kt)("h2",{id:"introduction"},"Introduction"),(0,a.kt)("p",null,"Before Ambari 2.0.0, configuring an Ambari cluster to use Kerberos involved setting up the Kerberos\nclient infrastructure on each host, creating the required identities, generating and distributing the\nneeded keytabs files, and updating the necessary configuration properties. On a small cluster this may\nnot seem to be too large of an effort; however as the size of the cluster increases, so does the amount\nof work that is involved."),(0,a.kt)("p",null,"This is where Ambari\u2019s Kerberos Automation facility can help. It performs all of these steps and\nalso helps to maintain the cluster as new services and hosts are added."),(0,a.kt)("p",null,"Kerberos automation can be invoked using Ambari\u2019s REST API as well as via the ",(0,a.kt)("em",{parentName:"p"},"Enable Kerberos Wizard"),"\nin the Ambari UI."),(0,a.kt)("a",{name:"how-it-works"}),(0,a.kt)("h3",{id:"how-it-works"},"How it works"),(0,a.kt)("p",null,"Stacks and services that can utilize Kerberos credentials for authentication must have a Kerberos\nDescriptor declaring required Kerberos identities and how to update configurations. The Ambari\ninfrastructure uses this data, and any updates applied by an administrator, to perform Kerberos\nrelated operations such as initially enabling Kerberos, enabling Kerberos for on hosts and added\ncomponents, regenerating credentials, and disabling Kerberos."),(0,a.kt)("p",null,"It should be notated that the Kerberos service is required to be installed on all hosts of the cluster\nbefore any automated tasks can be performed. If using the Ambari UI, this should happen as part of the\nEnable Kerberos wizard workflow."),(0,a.kt)("a",{name:"enabling-kerberos"}),(0,a.kt)("h3",{id:"enabling-kerberos"},"Enabling Kerberos"),(0,a.kt)("p",null,"When enabling Kerberos, all of the services in the cluster are expected to be stopped. The main\nreason for this is to avoid state issues as the services are stopped and then started when the cluster\nis transitioning to use Kerberos."),(0,a.kt)("p",null,"The following steps are taken to enable Kerberos on the cluster en masse:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Create or update accounts in the configured KDC (or Active Directory)"),(0,a.kt)("li",{parentName:"ol"},"Generate keytab files and distribute them to the appropriate hosts"),(0,a.kt)("li",{parentName:"ol"},"Update relevant configurations")),(0,a.kt)("a",{name:"adding-components"}),(0,a.kt)("h3",{id:"adding-components"},"Adding Components"),(0,a.kt)("p",null,"If Kerberos is enabled for the Ambari cluster, whenever new components are added, the new components\nwill automatically be configured for Kerberos, and any necessary principals and  keytab files will be\ncreated and distributed as needed."),(0,a.kt)("p",null,"For each new component, the following steps will occur before the component is installed and started:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Update relevant configurations"),(0,a.kt)("li",{parentName:"ol"},"Create or update accounts in the configured KDC (or Active Directory)"),(0,a.kt)("li",{parentName:"ol"},"Generate keytab files and distribute them to the appropriate hosts")),(0,a.kt)("a",{name:"adding-hosts"}),(0,a.kt)("h3",{id:"adding-hosts"},"Adding Hosts"),(0,a.kt)("p",null,"When adding a new host, the Kerberos client must be installed on it. This does not happen automatically;\nhowever the ",(0,a.kt)("em",{parentName:"p"},"Add Host Wizard")," in the Ambari UI will will perform this step if Kerberos was enabled for\nthe Ambari cluster. Once the host is added, generally one or more components are installed on\nit - see ",(0,a.kt)("a",{parentName:"p",href:"#adding-components"},"Adding Components"),"."),(0,a.kt)("a",{name:"regenerating-keytabs"}),(0,a.kt)("h3",{id:"regenerating-keytabs"},"Regenerating Keytabs"),(0,a.kt)("p",null,"Once a cluster has Kerberos enabled, it may be necessary to regenerate keytabs. There are two options\nfor this:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"all")," - create any missing principals and unconditionally update the passwords for existing principals, then create and distribute all relevant keytab files"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"missing")," - create any missing principals; then create and distribute keytab files for the newly-created principals")),(0,a.kt)("p",null,"In either case, the affected services should be restarted after the regeneration process is complete."),(0,a.kt)("p",null,"If performed through the Ambari UI, the user will be asked which keytab regeneration mode to use and\nwhether services are to be restarted or not. "),(0,a.kt)("a",{name:"disabling-kerberos"}),(0,a.kt)("h3",{id:"disabling-kerberos"},"Disabling Kerberos"),(0,a.kt)("p",null,"In the event Kerberos needs to be removed from the Ambari cluster, Ambari will remove the managed\nKerberos identities, keytab files, and Kerberos-specific configurations. The Ambari UI will perform\nthe steps of stopping and starting the services as well as removing the Kerberos service; however\nthis will need to be done manually, if using the Ambari REST API."))}p.isMDXComponent=!0}}]);